<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CONTRACTX — Converter</title>
<style>
:root{--bg:#070A0F;--stroke:rgba(255,255,255,.12);--stroke2:rgba(255,255,255,.22);--text:#EAF0FF;--muted:rgba(234,240,255,.65)}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);color:var(--text)}
.wrap{max-width:1100px;margin:0 auto;padding:24px}
.card{background:rgba(255,255,255,.05);border:1px solid var(--stroke);border-radius:16px;padding:16px;margin-bottom:16px}
h1{margin:0 0 10px}
label{font-size:12px;color:var(--muted)}
input,select{width:100%;padding:12px;border-radius:12px;border:1px solid var(--stroke2);background:#0d1117;color:#fff;font-size:15px}
.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.big{font-size:26px;font-weight:900}
.btn{margin-top:10px;padding:12px;border-radius:12px;border:1px solid var(--stroke2);background:rgba(255,255,255,.08);color:#fff;font-weight:800;cursor:pointer}
.warn{margin-top:10px;padding:10px;border-radius:12px;background:rgba(255,214,110,.12);border:1px solid rgba(255,214,110,.4);color:#FFD66E;font-size:13px}
.note{font-size:12px;color:var(--muted);margin-top:8px}
footer{opacity:.5;font-size:12px}
</style>
</head>
<body>
<div class="wrap">
<h1>CONTRACTX Converter</h1>

<div class="card">
<label>Instrument</label>
<select id="instrument">
<option value="ES">ES</option>
<option value="NQ">NQ</option>
<option value="YM">YM</option>
<option value="RTY">RTY</option>
<option value="6E">6E EUR/USD</option>
<option value="6B">6B GBP/USD</option>
<option value="6A">6A AUD/USD</option>
<option value="6N">6N NZD/USD</option>
<option value="6C">6C CAD/USD (invert)</option>
<option value="6J">6J JPY/USD (invert)</option>
<option value="6S">6S CHF/USD (invert)</option>
<option value="GC">GC Gold</option>
<option value="SI">SI Silver</option>
<option value="CL">CL Crude</option>
<option value="HG">HG Copper</option>
</select>
</div>

<div class="card">
<div class="row">
<div>
<label>Future aktuell</label>
<input id="futureNow" placeholder="z.B. 0.0064 oder 49308.25">
</div>
<div>
<label>Prop aktuell (Mid)</label>
<input id="propNow" placeholder="z.B. 155.42 oder 49310.50">
</div>
</div>
<button class="btn" id="btnSet">Offset setzen</button>
<div class="note">Offset: <b id="offsetVal">—</b></div>
</div>

<div class="card">
<label>Entry / SL / TP (Future)</label>
<div class="row">
<input id="entryF" placeholder="Entry">
<input id="slF" placeholder="SL">
</div>
<input id="tpF" placeholder="TP" style="margin-top:10px">
</div>

<div class="card">
<div class="big">Prop Entry: <span id="entryP">—</span></div>
<div class="big">Prop SL: <span id="slP">—</span></div>
<div class="big">Prop TP: <span id="tpP">—</span></div>
<button class="btn" id="copyEntry">Copy Entry</button>
<button class="btn" id="copySL">Copy SL</button>
<button class="btn" id="copyTP">Copy TP</button>
<div class="warn" id="invertHint" style="display:none">⚠️ Invertiertes FX‑Pair: Future SHORT = FX LONG (und umgekehrt)</div>
</div>

<footer>© 2026 CONTRACTX</footer>
</div>

<script>
const INVERTED = ["6C","6J","6S"];
let offset = null;

function n(v){const x=Number(String(v).replace(",", "."));return Number.isFinite(x)?x:null}
function isInverted(){return INVERTED.includes(document.getElementById("instrument").value)}
function toTarget(v){return isInverted()? (v>0?1/v:null) : v}
function fmt(v){if(!Number.isFinite(v)) return "—"; const a=Math.abs(v); if(a>=1000) return v.toFixed(2); if(a>=10) return v.toFixed(3); if(a>=1) return v.toFixed(5); return v.toFixed(7)}

function setOffset(){
  const f=n(futureNow.value), p=n(propNow.value);
  if(f===null||p===null) return;
  const base=toTarget(f);
  if(base===null) return;
  offset = p - base;
  offsetVal.textContent = fmt(offset);
  calc();
  save();
}

function calc(){
  if(offset===null){entryP.textContent=slP.textContent=tpP.textContent="—"; return;}
  const e=n(entryF.value), s=n(slF.value), t=n(tpF.value);
  entryP.textContent = e!==null? fmt(toTarget(e)+offset):"—";
  slP.textContent    = s!==null? fmt(toTarget(s)+offset):"—";
  tpP.textContent    = t!==null? fmt(toTarget(t)+offset):"—";
}

async function copyVal(v){
  if(!v||v==="—") return;
  const fb=()=>{const ta=document.createElement("textarea");ta.value=v;ta.style.position="fixed";ta.style.left="-9999px";document.body.appendChild(ta);ta.select();try{document.execCommand("copy")}catch{}document.body.removeChild(ta)}
  try{ if(navigator.clipboard && window.isSecureContext){ await navigator.clipboard.writeText(v);} else fb(); }catch{ fb(); }
}

function key(){return "contractx.state.v1"}
function save(){
  const d={instrument:instrument.value,futureNow:futureNow.value,propNow:propNow.value,entryF:entryF.value,slF:slF.value,tpF:tpF.value,offset};
  try{localStorage.setItem(key(), JSON.stringify(d));}catch{}
}
function load(){
  try{
    const d=JSON.parse(localStorage.getItem(key())||"null");
    if(!d) return;
    instrument.value=d.instrument||instrument.value;
    futureNow.value=d.futureNow||"";
    propNow.value=d.propNow||"";
    entryF.value=d.entryF||"";
    slF.value=d.slF||"";
    tpF.value=d.tpF||"";
    if(Number.isFinite(d.offset)){offset=d.offset; offsetVal.textContent=fmt(offset);}
    calc();
  }catch{}
}

btnSet.onclick=setOffset;
[futureNow,propNow,entryF,slF,tpF,instrument].forEach(el=>el.addEventListener("input", ()=>{calc(); save();}));
copyEntry.onclick=()=>copyVal(entryP.textContent);
copySL.onclick=()=>copyVal(slP.textContent);
copyTP.onclick=()=>copyVal(tpP.textContent);

instrument.addEventListener("change", ()=>{
  invertHint.style.display = isInverted()?"block":"none";
  calc(); save();
});

invertHint.style.display = isInverted()?"block":"none";
load();
</script>
</body>
</html>
